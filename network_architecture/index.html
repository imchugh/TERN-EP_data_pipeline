
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../visualisation/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Network architecture - TERN EP Data Pipeline</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#network-architecture" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TERN EP Data Pipeline" class="md-header__button md-logo" aria-label="TERN EP Data Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TERN EP Data Pipeline
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Network architecture
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TERN EP Data Pipeline" class="md-nav__button md-logo" aria-label="TERN EP Data Pipeline" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    TERN EP Data Pipeline
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main docs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Network architecture
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Network architecture
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#network-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Network nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loggers" class="md-nav__link">
    <span class="md-ellipsis">
      Loggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instrumentation" class="md-nav__link">
    <span class="md-ellipsis">
      Instrumentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modems" class="md-nav__link">
    <span class="md-ellipsis">
      Modems
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programming" class="md-nav__link">
    <span class="md-ellipsis">
      Programming
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#central-node" class="md-nav__link">
    <span class="md-ellipsis">
      Central node
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../visualisation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data visualisation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Code
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    data_merging
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#network-nodes" class="md-nav__link">
    <span class="md-ellipsis">
      Network nodes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Network nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#hardware" class="md-nav__link">
    <span class="md-ellipsis">
      Hardware
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Hardware">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#loggers" class="md-nav__link">
    <span class="md-ellipsis">
      Loggers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instrumentation" class="md-nav__link">
    <span class="md-ellipsis">
      Instrumentation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modems" class="md-nav__link">
    <span class="md-ellipsis">
      Modems
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programming" class="md-nav__link">
    <span class="md-ellipsis">
      Programming
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#central-node" class="md-nav__link">
    <span class="md-ellipsis">
      Central node
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="network-architecture">Network architecture</h1>
<p>This document describes general principles and architecture for the front end of the TERN-EP eddy covariance data processing pipeline.</p>
<h2 id="network-nodes">Network nodes</h2>
<h3 id="hardware">Hardware</h3>
<h4 id="loggers">Loggers</h4>
<p>Most sites use <a href="https://www.campbellsci.com.au/">Campbell Scientific</a>-based measurement systems; the remainder are <a href="https://www.licor.com/env/products/eddy-covariance/">Licor</a> SmartFlux systems. We currently consider Campbell systems the most versatile and extensible solution.</p>
<h4 id="instrumentation">Instrumentation</h4>
<p>Blah blah.</p>
<h4 id="modems">Modems</h4>
<p>A range of modem types are used (Maxon, Teltonika and Sierra); all have firmware that supports openVPN client, since this is the means of enabling incoming connections to site. </p>
<h3 id="programming">Programming</h3>
<p>Datalogger programs have historically differed from site to site, reflecting the fact that the network has gradually coalesced from sites that were originally funded as isolated research projects. As such  there are no network-wide variable conventions - variable names and units and data table names differ for the same quantity from site to site. </p>
<p>While this is undesirable, many site operators have built data processing pipelines around their own conventions, and it is thus difficult to impose new conventions in their stead.</p>
<p>We suggest instead that for future entrants joining the network, we provide a datalogger program that uses network-standard variable conventions. These are similar to, but not the same as, the CF-compliant standards used in the compiled netcdf files (see below xxx); operational variable naming is adopted where divergence from the standard conventions improves clarity for site operators. </p>
<p>To minimise network complexity, it is crucial to assure that this is the same at all sites.</p>
<p>For sites that already have established variable names embedded in data processing pipelines, we already have the capacity to map and translate the site-specific variable names to network standards, and can thus manage incoming data streams for these sites. However, this increases the complexity (and thus fragility) of the requisite processing pipeline, and increases the amount of information that must be centrally held to manage these data streams. As a solution, in future we aim to roll out modifications to existing datalogger programs at those sites. These modifications write an additional TERN EP-specific data table to memory that will contain data with the correct conventions.</p>
<h2 id="central-node">Central node</h2>
<p>Current state:</p>
<blockquote>
<p>Collection and processing of data occurs on a Windows virtual machine (VM) supplied by James Cook University. Data for all sites are collected and stored on a defined schedule. 'Fast' data are written to daily files on the logger  (half-hourly for 'slow' data, daily for ). 
* 
* The current plan is to move to a Linux VM for almost all of this functionality. This is complicated by the fact that the logger communications software requires a Windows OS. However, Campbell offers a Linux-based headless variant of Loggernet, which will be installed on the Linux VM. This requires a Windows machine for interaction and configuration, which will be a VM supplied by University of Melbourne. In the longer term </p>
</blockquote>
<p>A number of configuration files (in .yml format) are required. They contain:
* site-based hardware configurations, including:
    - modem information: type, login, serial number, SIM details, vpnip;
    - logger information: type, serial number, MAC address, vpnip, tables;
    - cameras: in progress.
* global and dimension (time, latitude, longitude) attributes that are (generally) common across all files;
* site-specific variable attributes, including:
    - variable name at site;
    - measurement units;
    - instrument type;
    - deployment height / depth;
    - statistic type;
    - logger table, and;
    - logger name. </p>
<p>Some notes on this. First, these configuration files will generally be the underlying data source for the project, but how they are generated may change over time. For example, a web-based UI could be used to generate the configuration files. This would solve the problem of how to collect and update site information from the PIs, and would provide an incentive for ensuring that the site information was up to date, since automated processing would otherwise not work.</p>
<p>Second, as a general principle, it is considered desirable to minimise the information held in  configuration files, and maximise the information held in the TERN DSA sites database. Some global attributes are already held in and retrieved from the TERN DSA sites database. A request has been made to include canopy height, tower height, soil description and vegetation description. Moreover, it is planned that the database will also act as an instrument inventory for the network. This will mean that </p>
<p>Third, it is in principle possible to retrieve measurement units and statistic type either from the file headers, or even from the loggers themselves using the logger <a href="https://www.campbellsci.com.au/web-api-article">API</a></p>
<p>The traditional PyFluxPro control files are no longer used - or at least the configuration files effectively replace them. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>